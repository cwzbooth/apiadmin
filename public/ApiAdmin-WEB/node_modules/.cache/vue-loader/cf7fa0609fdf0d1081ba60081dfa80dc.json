{"remainingRequest":"/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/node_modules/vue-loader/lib/index.js??vue-loader-options!/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/src/view/system/log.vue?vue&type=style&index=0&id=e2d06976&scoped=true&lang=css&","dependencies":[{"path":"/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/src/view/system/log.vue","mtime":1596016298726},{"path":"/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/www/wwwroot/apiadmin.fmoons.com/public/ApiAdmin-WEB/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n@import './log.less';\n",{"version":3,"sources":["log.vue"],"names":[],"mappings":";AACA","file":"log.vue","sourceRoot":"src/view/system","sourcesContent":["<style scoped>\n  @import './log.less';\n</style>\n<template>\n  <div>\n    <Row>\n      <Col span=\"24\">\n        <Card class=\"margin-bottom-10\">\n          <Form inline>\n            <FormItem class=\"margin-bottom-0\">\n              <Select v-model=\"searchConf.type\" clearable placeholder=\"请选择类别\" style=\"width:120px\">\n                <Option :value=\"1\">操作URL</Option>\n                <Option :value=\"2\">用户昵称</Option>\n                <Option :value=\"3\">用户ID</Option>\n              </Select>\n            </FormItem>\n            <FormItem class=\"margin-bottom-0\">\n              <Input v-model=\"searchConf.keywords\" placeholder=\"\"></Input>\n            </FormItem>\n            <FormItem class=\"margin-bottom-0\">\n              <Button type=\"primary\" @click=\"search\">{{ $t('find_button') }}/{{ $t('refresh_button') }}</Button>\n            </FormItem>\n          </Form>\n        </Card>\n      </Col>\n    </Row>\n    <Row>\n      <Col span=\"24\">\n        <Card>\n          <div>\n            <Table :loading=\"listLoading\" :columns=\"columnsList\" :data=\"tableData\" border disabled-hover></Table>\n          </div>\n          <div class=\"margin-top-15\" style=\"text-align: center\">\n            <Page :total=\"tableShow.listCount\" :current=\"tableShow.currentPage\"\n                  :page-size=\"tableShow.pageSize\" @on-change=\"changePage\"\n                  @on-page-size-change=\"changeSize\" show-elevator show-sizer show-total></Page>\n          </div>\n        </Card>\n      </Col>\n    </Row>\n  </div>\n</template>\n<script>\nimport { getList, del } from '@/api/log'\nimport expandRow from './table_expand.vue'\nimport { getDate } from '@/libs/tools'\n\nconst deleteButton = (vm, h, currentRow, index) => {\n  if (vm.buttonShow.del) {\n    return h('Poptip', {\n      props: {\n        confirm: true,\n        title: '您确定要删除这条数据吗? ',\n        transfer: true\n      },\n      on: {\n        'on-ok': () => {\n          del(currentRow.id).then(response => {\n            vm.tableData.splice(index, 1)\n            vm.$Message.success(response.data.msg)\n          })\n          currentRow.loading = false\n        }\n      }\n    }, [\n      h('Button', {\n        style: {\n          margin: '0 5px'\n        },\n        props: {\n          type: 'error',\n          placement: 'top',\n          loading: currentRow.isDeleting\n        }\n      }, vm.$t('delete_button'))\n    ])\n  }\n}\n\nexport default {\n  name: 'system_user',\n  components: { expandRow },\n  data () {\n    return {\n      columnsList: [\n        {\n          type: 'expand',\n          width: 50,\n          render: (h, params) => {\n            return h(expandRow, {\n              props: {\n                row: params.row\n              }\n            })\n          }\n        },\n        {\n          title: '行为名称',\n          align: 'center',\n          key: 'action_name'\n        },\n        {\n          title: '用户ID',\n          align: 'center',\n          key: 'uid',\n          width: 120\n        },\n        {\n          title: '用户昵称',\n          align: 'center',\n          key: 'nickname',\n          width: 100\n        },\n        {\n          title: '操作URL',\n          align: 'center',\n          key: 'url',\n          width: 200\n        },\n        {\n          title: '执行时间',\n          align: 'center',\n          width: 170,\n          render: (h, params) => {\n            return h('span', getDate(params.row.add_time, 'year'))\n          }\n        },\n        {\n          title: '操作',\n          align: 'center',\n          width: 125,\n          render: (h, params) => {\n            return h('div', [\n              deleteButton(this, h, params.row, params.index)\n            ])\n          }\n        }\n      ],\n      tableData: [],\n      tableShow: {\n        currentPage: 1,\n        pageSize: 10,\n        listCount: 0\n      },\n      searchConf: {\n        type: '',\n        keywords: '',\n        status: ''\n      },\n      modalSetting: {\n        show: false,\n        loading: false,\n        index: 0\n      },\n      buttonShow: {\n        del: true\n      },\n      listLoading: false\n    }\n  },\n  created () {\n    let vm = this\n    vm.getList()\n    vm.hasRule('Log/del').then(res => {\n      vm.buttonShow.del = res\n    })\n  },\n  methods: {\n    changePage (page) {\n      this.tableShow.currentPage = page\n      this.getList()\n    },\n    changeSize (size) {\n      this.tableShow.pageSize = size\n      this.getList()\n    },\n    search () {\n      this.tableShow.currentPage = 1\n      this.getList()\n    },\n    getList () {\n      let vm = this\n      let params = {\n        page: vm.tableShow.currentPage,\n        size: vm.tableShow.pageSize,\n        type: vm.searchConf.type,\n        keywords: vm.searchConf.keywords\n      }\n      vm.listLoading = true\n      getList(params).then(response => {\n        vm.tableData = response.data.data.list\n        vm.tableShow.listCount = response.data.data.count\n        vm.listLoading = false\n      })\n    }\n  }\n}\n</script>\n"]}]}